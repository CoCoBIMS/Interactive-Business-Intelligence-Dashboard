# Apache .htaccess for Cortina Consult Dashboards
# ==================================================
# Authentication required for ALL files
# ==================================================

# Enable authentication for all files
AuthType Basic
AuthName "Cortina Consult - Geschuetzter Bereich"

# Absolute path to .htpasswd file on server
AuthUserFile /var/www/html/.htpasswd

Require valid-user

# Protect .htaccess and .htpasswd files
<FilesMatch "^\.ht">
    Require all denied
</FilesMatch>

# Block direct access to CSV files - must go through api.php
<FilesMatch "\.csv$">
    Require all denied
</FilesMatch>

# Block direct access to data directory
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /

    # Block direct access to /data/
    RewriteRule ^data/ - [F,L]

    # Redirect root to dashboard index
    RewriteRule ^$ dashboard_index.html [L]
</IfModule>

# Fallback if mod_rewrite not available
<DirectoryMatch "/data/">
    Require all denied
</DirectoryMatch>

# Security headers
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-Frame-Options "DENY"
    Header always set X-XSS-Protection "1; mode=block"
</IfModule>
